<div *ngIf="race" class="wrapper">
  <img
    *ngIf="race.logo_url"
    class="race-logo"
    [src]="race.logo_url"
    alt="Race Logo"
  />
  <div class="race-details">
    <h1>
      {{ race.name | titlecase }} ({{ race.distance | number : "1.0-3"
      }}{{ race.distance_unit | distance }})
    </h1>
    <div>
      <span>
        {{ race.start_time | date : "EEEE, MMMM dd, yyyy, h:mm a" }}
      </span>
    </div>
  </div>
  <div>
    <a
      href="https://www.google.com/maps/search/{{ race.address_line_one }} {{
        race.town_name
      }}, CT"
      target="_blank"
      rel="no-referrer"
      mat-flat-button
      color="primary"
    >
      <mat-icon>pin_drop</mat-icon>
      {{ race.town_name }}, CT
    </a>
  </div>
  <div *ngIf="race.website_url || race.results_url">
    <ul>
      <li *ngIf="race.website_url">
        <a
          mat-stroked-button
          [href]="race.website_url"
          target="_blank"
          rel="no-referrer"
        >
          <mat-icon>open_in_new</mat-icon>Race Website
        </a>
      </li>
      <li *ngIf="race.results_url">
        <a
          mat-stroked-button
          [href]="race.results_url"
          target="_blank"
          rel="no-referrer"
        >
          <mat-icon>open_in_new</mat-icon>Race Results</a
        >
      </li>
    </ul>
  </div>
</div>
<mat-tab-group>
  <mat-tab>
    <ng-template mat-tab-label> Results ({{ results().length }}) </ng-template>
    <table *ngIf="results().length > 0" mat-table [dataSource]="results()">
      <ng-container matColumnDef="place">
        <th mat-header-cell *matHeaderCellDef>Place</th>
        <td mat-cell *matCellDef="let element; let i = index">
          <div class="placement">
            {{ i + 1 }}
            <mat-icon
              *ngIf="i <= 2"
              [ngClass]="{
                gold: i === 0,
                silver: i === 1,
                bronze: i === 2
              }"
            >
              emoji_events
            </mat-icon>
          </div>
        </td>
      </ng-container>

      <ng-container matColumnDef="runner">
        <th mat-header-cell *matHeaderCellDef>Runner</th>
        <td mat-cell *matCellDef="let element">
          <a [routerLink]="['/runners', element.runner_id]">
            <img [src]="element.avatar_url" alt="profile image" />
            {{ element.first_name }} {{ element.last_name }}
          </a>
        </td>
      </ng-container>

      <ng-container matColumnDef="bib">
        <th mat-header-cell *matHeaderCellDef>Bib</th>
        <td mat-cell *matCellDef="let element">
          {{ element.bib_number }}
        </td>
      </ng-container>

      <ng-container matColumnDef="sex">
        <th mat-header-cell *matHeaderCellDef>Sex</th>
        <td mat-cell *matCellDef="let element">
          {{ element.sex | titlecase }}
        </td>
      </ng-container>

      <ng-container matColumnDef="total-time">
        <th mat-header-cell *matHeaderCellDef>Time</th>
        <td mat-cell *matCellDef="let element">
          {{ element.hours }}:{{ element.minutes }}:{{ element.seconds }}
        </td>
      </ng-container>

      <ng-container matColumnDef="kilometer-pace">
        <th mat-header-cell *matHeaderCellDef>Kilometer Pace</th>
        <td mat-cell *matCellDef="let element">
          {{ element.kilometer_pace }}
        </td>
      </ng-container>

      <ng-container matColumnDef="mile-pace">
        <th mat-header-cell *matHeaderCellDef>Mile Pace</th>
        <td mat-cell *matCellDef="let element">
          {{ element.mile_pace }}
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayColumns"></tr>
    </table>
  </mat-tab>
  <mat-tab>
    <ng-template mat-tab-label>Analysis</ng-template>
    Coming soon!
  </mat-tab>
</mat-tab-group>
